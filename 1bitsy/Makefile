# Project name
BIN = 1bitsy

# Include paths
OPENCM3_DIR = ./libopencm3

INC = -I$(OPENCM3_DIR)/include \
      -L$(OPENCM3_DIR)/lib

# Setup the target MCU used with libopencm3
OPENCM3_DEVICE = stm32f415rgt
OPENCM3_TARGET = stm32/f4
DEF = -DSTM32F4

# CPU architecture
ARCHFLAGS = -mcpu=cortex-m4
FPFLAGS = -mfloat-abi=hard -mfpu=fpv4-sp-d16

# Linker script (generated by libopencm3)
SRC_LD = $(BUILD_DIR)/$(OPENCM3_DEVICE).ld

# Black Magic Probe setup (optional):
#BLACKMAGIC_PORT = /dev/ttyACM0

include ../cm-makefile/config.mk
include ../cm-makefile/blackmagic.mk
include ../cm-makefile/libopencm3.mk    # Builds libopencm3
include ../cm-makefile/libopencm3_ld.mk # Generates linker script
include ../cm-makefile/rules.mk
